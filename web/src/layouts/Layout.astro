---
import type { GlobalSettings } from "../lib/sanityClient";
import { buildLayoutPropsWithSEO } from "../lib/seo";
import SEO from "../components/SEO.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import PageTransition from "../components/PageTransition.astro";
import "../styles/global.css";
import motionClientUrl from "../lib/nativeScroll.ts?url";

interface Props {
  // Configuración SEO específica de la página (opcional)
  title?: string;
  description?: string;
  ogImageUrl?: string | null;
  siteTitle?: string;
  siteDescription?: string;
  faviconUrl?: string | null;
  footerTitle?: string;
  seoFooterText?: string;
  
  // Configuración global del sitio (obligatoria)
  globalSettings: GlobalSettings;
}

const {
  title,
  description,
  ogImageUrl,
  siteTitle,
  siteDescription,
  faviconUrl,
  footerTitle,
  seoFooterText,
  globalSettings
} = Astro.props;

// Construir props del layout con configuración SEO
const layoutProps = buildLayoutPropsWithSEO({
  title,
  description,
  ogImageUrl,
  siteTitle,
  siteDescription,
  faviconUrl,
  footerTitle,
  seoFooterText,
}, globalSettings);
---
<!doctype html>
<html lang="es">
	<head>
		<!-- Componente SEO -->
		<SEO 
			title={title}
			description={description}
			ogImageUrl={ogImageUrl}
			siteTitle={siteTitle}
			siteDescription={siteDescription}
			faviconUrl={faviconUrl}
			footerTitle={footerTitle}
			seoFooterText={seoFooterText}
			globalSettings={globalSettings}
		/>
		
		<!-- Google Fonts - Poppins, Libre Baskerville, Inter -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Libre+Baskerville:wght@400;700&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
		
		<!-- Shoelace CSS -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/themes/light.css" />
		
		<!-- TailwindCSS inyectado via import en el frontmatter -->
		
	</head>
	<body class="font-serif-elegant">
		<script type="module" src={motionClientUrl}></script>
		<PageTransition />
		<Header 
			logoUrl={layoutProps.brand?.logo?.asset?.url}
			logoAlt={layoutProps.brand?.logo?.alt}
			navMain={layoutProps.navMain}
			phone={layoutProps.contact?.phone}
			whatsapp={layoutProps.contact?.whatsapp}
			bookingUrl={layoutProps.bookingUrl}
		/>
		<main>
			<slot />
		</main>
		<Footer 
			logoUrl={layoutProps.brand?.logo?.asset?.url}
			logoAlt={layoutProps.brand?.logo?.alt}
			footerTitle={layoutProps.footerTitle}
			seoFooterText={layoutProps.seoFooterText}
			navMain={layoutProps.navMain}
			legalLinks={layoutProps.legalLinks}
			socialLinks={layoutProps.socialLinks}
			contact={layoutProps.contact}
		/>
		
		<!-- Shoelace JS -->
		<script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/shoelace-autoloader.js"></script>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
