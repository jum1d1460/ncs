---
import ResponsiveImage from "../ResponsiveImage.astro";

interface ServiceImage {
  asset?: { _ref?: string; url?: string };
  alt?: string;
}

interface ServiceData {
  title?: string;
  durationMinutes?: number;
  priceType?: 'fixed' | 'consult';
  price?: number;
  shortDescription?: string;
  longDescription?: any[];
  cardImage?: ServiceImage;
  blockImage?: ServiceImage;
}

interface Props {
  service?: ServiceData;
  variant?: 'card' | 'detailed';
  showPrice?: boolean;
}

const {
  service = {},
  variant = 'card',
  showPrice = true
} = Astro.props as Props;

const priceLabel = service?.priceType === 'fixed' && service?.price
  ? `${service.price} â‚¬`
  : 'A consultar';
---

{
  variant === 'card' ? (
    <article class="w-full rounded-lg border border-gray-200 p-4 bg-white shadow-sm">
      {service?.cardImage && (
        <ResponsiveImage image={service.cardImage} alt={service.cardImage?.alt} class="w-full rounded-md mb-4" aspectRatio="4/3" />
      )}
      <h3 class="text-lg font-semibold text-gray-900">{service?.title}</h3>
      <div class="mt-1 text-sm text-gray-600 flex gap-3">
        {service?.durationMinutes ? <span>{service.durationMinutes} min</span> : null}
        {showPrice ? <span aria-label="precio">{priceLabel}</span> : null}
      </div>
      {service?.shortDescription && (
        <p class="mt-3 text-gray-700 text-sm">{service.shortDescription}</p>
      )}
    </article>
  ) : (
    <section class="w-full grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
      {service?.blockImage && (
        <ResponsiveImage image={service.blockImage} alt={service.blockImage?.alt} class="w-full rounded-md" aspectRatio="16/9" />
      )}
      <div>
        <h3 class="text-2xl font-semibold text-gray-900">{service?.title}</h3>
        <div class="mt-2 text-sm text-gray-600 flex gap-3">
          {service?.durationMinutes ? <span>{service.durationMinutes} min</span> : null}
          {showPrice ? <span aria-label="precio">{priceLabel}</span> : null}
        </div>
        {service?.longDescription && (
          <div class="prose prose-slate mt-4 max-w-none">
            {service.longDescription.map((block: any) => (
              <p>{block?.children?.map((c: any) => c?.text).join(' ')}</p>
            ))}
          </div>
        )}
      </div>
    </section>
  )
}


