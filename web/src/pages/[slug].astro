---
import Layout from '../layouts/Layout.astro';
import { sanityClient } from "../lib/sanityClient";
import PageRenderer from "../components/PageRenderer.astro";

export async function getStaticPaths() {
    const pages = await sanityClient.fetch(`
        *[_type == "page" && slug.current != "inicio"] {
            slug,
            title,
            blocks[]{
                _type,
                ...
            }
        }
    `);

    return pages.map((page: { slug: { current: string }, title: string, blocks: any[] }) => ({
        params: { slug: page.slug.current },
        props: { page }
    }));
}

const { page } = Astro.props;
---

<Layout title={page?.title}>
  <PageRenderer blocks={page?.blocks} />
</Layout>